!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("pzlStreamLib",[],e):"object"==typeof exports?exports.pzlStreamLib=e():t.pzlStreamLib=e()}(this,(function(){return function(){var t={442:function(t){t.exports=function(){var t=Object.prototype.toString,e=function(){function t(t){this.name="InvalidStateError",this.message=t}return t.prototype=new Error,t.prototype.constructor=t,t}();function n(n,r){if("function"==typeof n&&(n=n()),"[object Object]"!==t.call(n))throw new e("Stately.js: Invalid states object: `"+n+"`.");function o(t,e){for(var n in s[t])if(s[t].hasOwnProperty(n)&&n.toLowerCase()===e.toLowerCase())return s[t][n]}var i,s={getMachineState:function(){return i.name},setMachineState:function t(n){var r,c,a=arguments[1],u=i;if("string"==typeof n&&(n=s[n]),!n||!n.name||!s[n.name])throw new e("Stately.js: Transitioned into invalid state: `"+t.caller+"`.");return i=n,(c=o(u.name,"onLeave"))&&"function"==typeof c&&c.call(s,a,u.name,i.name),(r=o(i.name,"onEnter"))&&"function"==typeof r&&r.call(s,a,u.name,n.name),this},getMachineEvents:function(){var t=[];for(var e in i)i.hasOwnProperty(e)&&"function"==typeof i[e]&&t.push(e);return t}},c={getMachineState:s.getMachineState,getMachineEvents:s.getMachineEvents},a=function(e,n,r){return function(){var a,u,l,h=c;return s[e]!==i?(r&&(h=r.apply(s,arguments)),h):((a=o(i.name,"onBefore"+n))&&"function"==typeof a&&a.call(s,n,i.name,i.name),void 0===(h=s[e][n].apply(s,arguments))?(l=i,h=c):"string"==typeof h?(l=s[h],h=c):"[object Object]"===t.call(h)?(l=h===s?i:h,h=c):"[object Array]"===t.call(h)&&h.length>=1&&(l="string"==typeof h[0]?s[h[0]]:h[0],h=h[1]),(u=o(i.name,"onAfter"+n))&&"function"==typeof u&&u.call(s,n,i.name,l.name),s.setMachineState(l,n),h)}};for(var u in n)if(n.hasOwnProperty(u)){for(var l in s[u]=n[u],s[u])s[u].hasOwnProperty(l)&&("string"==typeof s[u][l]&&(s[u][l]=function(t){return function(){return this[t]}}(s[u][l])),"function"!=typeof s[u][l]||/^onEnter$/i.test(l)||/^onLeave$/i.test(l)||/^onBefore/i.test(l)||/^onAfter/i.test(l)||(c[l]=a(u,l,c[l])));s[u].name=u,i||(i=s[u])}if(void 0!==s[r]&&(i=s[r]),!i)throw new e("Stately.js: Invalid initial state.");return c}return n.machine=function(t,e){return new n(t,e)},n.InvalidStateError=e,n}()},61:function(t,e,n){var r=n(698).default;function o(){"use strict";t.exports=o=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},n=Object.prototype,i=n.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),s=new x(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return P()}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var c=S(s,n);if(c){if(c===p)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var a=f(t,e,n);if("normal"===a.type){if(r=n.done?"completed":"suspendedYield",a.arg===p)continue;return{value:a.arg,done:n.done}}"throw"===a.type&&(r="completed",n.method="throw",n.arg=a.arg)}}}(t,n,s),i}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var p={};function g(){}function d(){}function v(){}var y={};l(y,c,(function(){return this}));var b=Object.getPrototypeOf,_=b&&b(b(O([])));_&&_!==n&&i.call(_,c)&&(y=_);var m=v.prototype=g.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(o,s,c,a){var u=f(t[o],t,s);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==r(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,c,a)}),(function(t){n("throw",t,c,a)})):e.resolve(h).then((function(t){l.value=t,c(l)}),(function(t){return n("throw",t,c,a)}))}a(u.arg)}var o;this._invoke=function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return p;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var r=f(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,p;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function O(t){if(t){var e=t[c];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(i.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:P}}function P(){return{value:void 0,done:!0}}return d.prototype=v,l(m,"constructor",v),l(v,"constructor",d),d.displayName=l(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,l(t,u,"GeneratorFunction")),t.prototype=Object.create(m),t},e.awrap=function(t){return{__await:t}},w(k.prototype),l(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var s=new k(h(t,n,r,o),i);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},w(m),l(m,u,"Generator"),l(m,c,(function(){return this})),l(m,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=O,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=i.call(o,"catchLoc"),a=i.call(o,"finallyLoc");if(c&&a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;E(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:O(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},698:function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},687:function(t,e,n){var r=n(61)();t.exports=r;try{regeneratorRuntime=r}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return function(){"use strict";var t={};function e(t,e,n,r,o,i,s){try{var c=t[i](s),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}function r(t){return function(){var n=this,r=arguments;return new Promise((function(o,i){var s=t.apply(n,r);function c(t){e(s,o,i,c,a,"next",t)}function a(t){e(s,o,i,c,a,"throw",t)}c(void 0)}))}}n.r(t),n.d(t,{AbortError:function(){return T},DefaultHttpClient:function(){return pt},HttpClient:function(){return W},HttpError:function(){return O},HttpResponse:function(){return N},HttpTransportType:function(){return o},HubConnection:function(){return qt},HubConnectionBuilder:function(){return Kt},HubConnectionState:function(){return Ft},JsonHubProtocol:function(){return zt},LogLevel:function(){return M},MessageType:function(){return Rt},NullLogger:function(){return F},Subject:function(){return Mt},TimeoutError:function(){return P},TransferFormat:function(){return i},VERSION:function(){return U}});var o,i,s=n(687),c=n.n(s);function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function g(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function d(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||g(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}!function(t){t[t.None=0]="None",t[t.WebSockets=1]="WebSockets",t[t.ServerSentEvents=2]="ServerSentEvents",t[t.LongPolling=4]="LongPolling"}(o||(o={})),function(t){t[t.Text=1]="Text",t[t.Binary=2]="Binary"}(i||(i={}));var v=[0,2e3,1e4,3e4,null],y=function(){function t(e){l(this,t),this._retryDelays=void 0!==e?[].concat(d(e),[null]):v}return f(t,[{key:"nextRetryDelayInMilliseconds",value:function(t){return this._retryDelays[t.previousRetryCount]}}]),t}();function b(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],s=!0,c=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(c)throw o}}return i}}(t,e)||g(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_(t,e)}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_(t,e)}function w(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function k(t){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},k(t)}function S(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function C(t,e,n){return C=S()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&_(o,n.prototype),o},C.apply(null,arguments)}function E(t){var e="function"==typeof Map?new Map:void 0;return E=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return C(t,arguments,k(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_(r,t)},E(t)}function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k(t);if(e){var o=k(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return w(this,n)}}var O=function(t){m(n,t);var e=x(n);function n(t,r){var o;l(this,n);var i=(this instanceof n?this.constructor:void 0).prototype;return(o=e.call(this,"".concat(t,": Status code '").concat(r,"'"))).statusCode=r,o.__proto__=i,o}return f(n)}(E(Error)),P=function(t){m(n,t);var e=x(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"A timeout occurred.";l(this,n);var o=(this instanceof n?this.constructor:void 0).prototype;return(t=e.call(this,r)).__proto__=o,t}return f(n)}(E(Error)),T=function(t){m(n,t);var e=x(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"An abort occurred.";l(this,n);var o=(this instanceof n?this.constructor:void 0).prototype;return(t=e.call(this,r)).__proto__=o,t}return f(n)}(E(Error)),j=function(t){m(n,t);var e=x(n);function n(t,r){var o;l(this,n);var i=(this instanceof n?this.constructor:void 0).prototype;return(o=e.call(this,t)).transport=r,o.errorType="UnsupportedTransportError",o.__proto__=i,o}return f(n)}(E(Error)),I=function(t){m(n,t);var e=x(n);function n(t,r){var o;l(this,n);var i=(this instanceof n?this.constructor:void 0).prototype;return(o=e.call(this,t)).transport=r,o.errorType="DisabledTransportError",o.__proto__=i,o}return f(n)}(E(Error)),D=function(t){m(n,t);var e=x(n);function n(t,r){var o;l(this,n);var i=(this instanceof n?this.constructor:void 0).prototype;return(o=e.call(this,t)).transport=r,o.errorType="FailedToStartTransportError",o.__proto__=i,o}return f(n)}(E(Error)),R=function(t){m(n,t);var e=x(n);function n(t){var r;l(this,n);var o=(this instanceof n?this.constructor:void 0).prototype;return(r=e.call(this,t)).errorType="FailedToNegotiateWithServerError",r.__proto__=o,r}return f(n)}(E(Error)),A=function(t){m(n,t);var e=x(n);function n(t,r){var o;l(this,n);var i=(this instanceof n?this.constructor:void 0).prototype;return(o=e.call(this,t)).innerErrors=r,o.__proto__=i,o}return f(n)}(E(Error));function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function H(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var M,N=f((function t(e,n,r){l(this,t),this.statusCode=e,this.statusText=n,this.content=r})),W=function(){function t(){l(this,t)}return f(t,[{key:"get",value:function(t,e){return this.send(H(H({},e),{},{method:"GET",url:t}))}},{key:"post",value:function(t,e){return this.send(H(H({},e),{},{method:"POST",url:t}))}},{key:"delete",value:function(t,e){return this.send(H(H({},e),{},{method:"DELETE",url:t}))}},{key:"getCookieString",value:function(t){return""}}]),t}();!function(t){t[t.Trace=0]="Trace",t[t.Debug=1]="Debug",t[t.Information=2]="Information",t[t.Warning=3]="Warning",t[t.Error=4]="Error",t[t.Critical=5]="Critical",t[t.None=6]="None"}(M||(M={}));var F=function(){function t(){l(this,t)}return f(t,[{key:"log",value:function(t,e){}}]),t}();function q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function B(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?q(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}F.instance=new F;var U="6.0.9",z=function(){function t(){l(this,t)}return f(t,null,[{key:"isRequired",value:function(t,e){if(null==t)throw new Error("The '".concat(e,"' argument is required."))}},{key:"isNotEmpty",value:function(t,e){if(!t||t.match(/^\s*$/))throw new Error("The '".concat(e,"' argument should not be empty."))}},{key:"isIn",value:function(t,e,n){if(!(t in e))throw new Error("Unknown ".concat(n," value: ").concat(t,"."))}}]),t}(),X=function(){function t(){l(this,t)}return f(t,null,[{key:"isBrowser",get:function(){return"object"===("undefined"==typeof window?"undefined":u(window))&&"object"===u(window.document)}},{key:"isWebWorker",get:function(){return"object"===("undefined"==typeof self?"undefined":u(self))&&"importScripts"in self}},{key:"isReactNative",get:function(){return"object"===("undefined"==typeof window?"undefined":u(window))&&void 0===window.document}},{key:"isNode",get:function(){return!this.isBrowser&&!this.isWebWorker&&!this.isReactNative}}]),t}();function G(t,e){var n="";return J(t)?(n="Binary data of length ".concat(t.byteLength),e&&(n+=". Content: '".concat(function(t){var e=new Uint8Array(t),n="";return e.forEach((function(t){n+="0x".concat(t<16?"0":"").concat(t.toString(16)," ")})),n.substr(0,n.length-1)}(t),"'"))):"string"==typeof t&&(n="String data of length ".concat(t.length),e&&(n+=". Content: '".concat(t,"'"))),n}function J(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function K(t,e,n,r,o,i,s){return V.apply(this,arguments)}function V(){return V=r(c().mark((function t(e,n,r,o,i,s,u){var l,h,f,p,g,d,v,y;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l={},!i){t.next=6;break}return t.next=4,i();case 4:(h=t.sent)&&(l=a({},"Authorization","Bearer ".concat(h)));case 6:return f=Z(),p=b(f,2),g=p[0],d=p[1],l[g]=d,e.log(M.Trace,"(".concat(n," transport) sending data. ").concat(G(s,u.logMessageContent),".")),v=J(s)?"arraybuffer":"text",t.next=12,r.post(o,{content:s,headers:B(B({},l),u.headers),responseType:v,timeout:u.timeout,withCredentials:u.withCredentials});case 12:y=t.sent,e.log(M.Trace,"(".concat(n," transport) request complete. Response status: ").concat(y.statusCode,"."));case 14:case"end":return t.stop()}}),t)}))),V.apply(this,arguments)}function $(t){return void 0===t?new Y(M.Information):null===t?F.instance:void 0!==t.log?t:new Y(t)}var Q=function(){function t(e,n){l(this,t),this._subject=e,this._observer=n}return f(t,[{key:"dispose",value:function(){var t=this._subject.observers.indexOf(this._observer);t>-1&&this._subject.observers.splice(t,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch((function(t){}))}}]),t}(),Y=function(){function t(e){l(this,t),this._minLevel=e,this.out=console}return f(t,[{key:"log",value:function(t,e){if(t>=this._minLevel){var n="[".concat((new Date).toISOString(),"] ").concat(M[t],": ").concat(e);switch(t){case M.Critical:case M.Error:this.out.error(n);break;case M.Warning:this.out.warn(n);break;case M.Information:this.out.info(n);break;default:this.out.log(n)}}}}]),t}();function Z(){var t="X-SignalR-User-Agent";return X.isNode&&(t="User-Agent"),[t,tt(U,et(),rt(),nt())]}function tt(t,e,n,r){var o="Microsoft SignalR/",i=t.split(".");return o+="".concat(i[0],".").concat(i[1]),o+=" (".concat(t,"; "),o+=e&&""!==e?"".concat(e,"; "):"Unknown OS; ",o+="".concat(n),o+=r?"; ".concat(r):"; Unknown Runtime Version",o+=")"}function et(){if(!X.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function nt(){if(X.isNode)return process.versions.node}function rt(){return X.isNode?"NodeJS":"Browser"}function ot(t){return t.stack?t.stack:t.message?t.message:"".concat(t)}function it(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function st(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?it(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k(t);if(e){var o=k(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return w(this,n)}}var at=function(t){m(i,t);var e,o=ct(i);function i(t){var e;if(l(this,i),(e=o.call(this))._logger=t,"undefined"==typeof fetch){var r=require;e._jar=new(r("tough-cookie").CookieJar),e._fetchType=r("node-fetch"),e._fetchType=r("fetch-cookie")(e._fetchType,e._jar)}else e._fetchType=fetch.bind(function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("could not find global")}());if("undefined"==typeof AbortController){var s=require;e._abortControllerType=s("abort-controller")}else e._abortControllerType=AbortController;return e}return f(i,[{key:"send",value:(e=r(c().mark((function t(e){var n,r,o,i,s,a,u,l,h=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.abortSignal||!e.abortSignal.aborted){t.next=2;break}throw new T;case 2:if(e.method){t.next=4;break}throw new Error("No method defined.");case 4:if(e.url){t.next=6;break}throw new Error("No url defined.");case 6:return n=new this._abortControllerType,e.abortSignal&&(e.abortSignal.onabort=function(){n.abort(),r=new T}),o=null,e.timeout&&(i=e.timeout,o=setTimeout((function(){n.abort(),h._logger.log(M.Warning,"Timeout from HTTP request."),r=new P}),i)),t.prev=10,t.next=13,this._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0===e.withCredentials?"include":"same-origin",headers:st({"Content-Type":"text/plain;charset=UTF-8","X-Requested-With":"XMLHttpRequest"},e.headers),method:e.method,mode:"cors",redirect:"follow",signal:n.signal});case 13:s=t.sent,t.next=22;break;case 16:if(t.prev=16,t.t0=t.catch(10),!r){t.next=20;break}throw r;case 20:throw this._logger.log(M.Warning,"Error from HTTP request. ".concat(t.t0,".")),t.t0;case 22:return t.prev=22,o&&clearTimeout(o),e.abortSignal&&(e.abortSignal.onabort=null),t.finish(22);case 26:if(s.ok){t.next=31;break}return t.next=29,ut(s,"text");case 29:throw a=t.sent,new O(a||s.statusText,s.status);case 31:return u=ut(s,e.responseType),t.next=34,u;case 34:return l=t.sent,t.abrupt("return",new N(s.status,s.statusText,l));case 36:case"end":return t.stop()}}),t,this,[[10,16,22,26]])}))),function(t){return e.apply(this,arguments)})},{key:"getCookieString",value:function(t){var e="";return X.isNode&&this._jar&&this._jar.getCookies(t,(function(t,n){return e=n.join("; ")})),e}}]),i}(W);function ut(t,e){var n;switch(e){case"arraybuffer":n=t.arrayBuffer();break;case"text":default:n=t.text();break;case"blob":case"document":case"json":throw new Error("".concat(e," is not supported."))}return n}function lt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k(t);if(e){var o=k(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return w(this,n)}}var ht=function(t){m(n,t);var e=lt(n);function n(t){var r;return l(this,n),(r=e.call(this))._logger=t,r}return f(n,[{key:"send",value:function(t){var e=this;return t.abortSignal&&t.abortSignal.aborted?Promise.reject(new T):t.method?t.url?new Promise((function(n,r){var o=new XMLHttpRequest;o.open(t.method,t.url,!0),o.withCredentials=void 0===t.withCredentials||t.withCredentials,o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var i=t.headers;i&&Object.keys(i).forEach((function(t){o.setRequestHeader(t,i[t])})),t.responseType&&(o.responseType=t.responseType),t.abortSignal&&(t.abortSignal.onabort=function(){o.abort(),r(new T)}),t.timeout&&(o.timeout=t.timeout),o.onload=function(){t.abortSignal&&(t.abortSignal.onabort=null),o.status>=200&&o.status<300?n(new N(o.status,o.statusText,o.response||o.responseText)):r(new O(o.response||o.responseText||o.statusText,o.status))},o.onerror=function(){e._logger.log(M.Warning,"Error from HTTP request. ".concat(o.status,": ").concat(o.statusText,".")),r(new O(o.statusText,o.status))},o.ontimeout=function(){e._logger.log(M.Warning,"Timeout from HTTP request."),r(new P)},o.send(t.content||"")})):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}]),n}(W);function ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k(t);if(e){var o=k(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return w(this,n)}}var pt=function(t){m(n,t);var e=ft(n);function n(t){var r;if(l(this,n),r=e.call(this),"undefined"!=typeof fetch||X.isNode)r._httpClient=new at(t);else{if("undefined"==typeof XMLHttpRequest)throw new Error("No usable HttpClient found.");r._httpClient=new ht(t)}return r}return f(n,[{key:"send",value:function(t){return t.abortSignal&&t.abortSignal.aborted?Promise.reject(new T):t.method?t.url?this._httpClient.send(t):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}},{key:"getCookieString",value:function(t){return this._httpClient.getCookieString(t)}}]),n}(W),gt=f((function t(){l(this,t)}));gt.Authorization="Authorization",gt.Cookie="Cookie";var dt=function(){function t(){l(this,t),this._isAborted=!1,this.onabort=null}return f(t,[{key:"abort",value:function(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}},{key:"signal",get:function(){return this}},{key:"aborted",get:function(){return this._isAborted}}]),t}();function vt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function yt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?vt(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var bt=function(){function t(e,n,r,o){l(this,t),this._httpClient=e,this._accessTokenFactory=n,this._logger=r,this._pollAbort=new dt,this._options=o,this._running=!1,this.onreceive=null,this.onclose=null}var e,n,o,s;return f(t,[{key:"pollAborted",get:function(){return this._pollAbort.aborted}},{key:"connect",value:function(){var t=r(c().mark((function t(e,n){var r,o,s,u,l,h,f,p,g;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(z.isRequired(e,"url"),z.isRequired(n,"transferFormat"),z.isIn(n,i,"transferFormat"),this._url=e,this._logger.log(M.Trace,"(LongPolling transport) Connecting."),n!==i.Binary||"undefined"==typeof XMLHttpRequest||"string"==typeof(new XMLHttpRequest).responseType){t.next=7;break}throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");case 7:return r=Z(),o=b(r,2),s=o[0],u=o[1],l=yt(a({},s,u),this._options.headers),h={abortSignal:this._pollAbort.signal,headers:l,timeout:1e5,withCredentials:this._options.withCredentials},n===i.Binary&&(h.responseType="arraybuffer"),t.next=13,this._getAccessToken();case 13:return f=t.sent,this._updateHeaderToken(h,f),p="".concat(e,"&_=").concat(Date.now()),this._logger.log(M.Trace,"(LongPolling transport) polling: ".concat(p,".")),t.next=19,this._httpClient.get(p,h);case 19:200!==(g=t.sent).statusCode?(this._logger.log(M.Error,"(LongPolling transport) Unexpected response code: ".concat(g.statusCode,".")),this._closeError=new O(g.statusText||"",g.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,h);case 22:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"_getAccessToken",value:(s=r(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._accessTokenFactory){t.next=4;break}return t.next=3,this._accessTokenFactory();case 3:return t.abrupt("return",t.sent);case 4:return t.abrupt("return",null);case 5:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"_updateHeaderToken",value:function(t,e){t.headers||(t.headers={}),e?t.headers[gt.Authorization]="Bearer ".concat(e):t.headers[gt.Authorization]&&delete t.headers[gt.Authorization]}},{key:"_poll",value:(o=r(c().mark((function t(e,n){var r,o,i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0;case 1:if(!this._running){t.next=20;break}return t.next=4,this._getAccessToken();case 4:return r=t.sent,this._updateHeaderToken(n,r),t.prev=6,o="".concat(e,"&_=").concat(Date.now()),this._logger.log(M.Trace,"(LongPolling transport) polling: ".concat(o,".")),t.next=11,this._httpClient.get(o,n);case 11:204===(i=t.sent).statusCode?(this._logger.log(M.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):200!==i.statusCode?(this._logger.log(M.Error,"(LongPolling transport) Unexpected response code: ".concat(i.statusCode,".")),this._closeError=new O(i.statusText||"",i.statusCode),this._running=!1):i.content?(this._logger.log(M.Trace,"(LongPolling transport) data received. ".concat(G(i.content,this._options.logMessageContent),".")),this.onreceive&&this.onreceive(i.content)):this._logger.log(M.Trace,"(LongPolling transport) Poll timed out, reissuing."),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(6),this._running?t.t0 instanceof P?this._logger.log(M.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=t.t0,this._running=!1):this._logger.log(M.Trace,"(LongPolling transport) Poll errored after shutdown: ".concat(t.t0.message));case 18:t.next=1;break;case 20:return t.prev=20,this._logger.log(M.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose(),t.finish(20);case 24:case"end":return t.stop()}}),t,this,[[0,,20,24],[6,15]])}))),function(t,e){return o.apply(this,arguments)})},{key:"send",value:(n=r(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._running){t.next=2;break}return t.abrupt("return",Promise.reject(new Error("Cannot send until the transport is connected")));case 2:return t.abrupt("return",K(this._logger,"LongPolling",this._httpClient,this._url,this._accessTokenFactory,e,this._options));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"stop",value:(e=r(c().mark((function t(){var e,n,r,o,i,s,a;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._logger.log(M.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort(),t.prev=3,t.next=6,this._receiving;case 6:return this._logger.log(M.Trace,"(LongPolling transport) sending DELETE request to ".concat(this._url,".")),e={},n=Z(),r=b(n,2),o=r[0],i=r[1],e[o]=i,s={headers:yt(yt({},e),this._options.headers),timeout:this._options.timeout,withCredentials:this._options.withCredentials},t.next=13,this._getAccessToken();case 13:return a=t.sent,this._updateHeaderToken(s,a),t.next=17,this._httpClient.delete(this._url,s);case 17:this._logger.log(M.Trace,"(LongPolling transport) DELETE request sent.");case 18:return t.prev=18,this._logger.log(M.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose(),t.finish(18);case 22:case"end":return t.stop()}}),t,this,[[3,,18,22]])}))),function(){return e.apply(this,arguments)})},{key:"_raiseOnClose",value:function(){if(this.onclose){var t="(LongPolling transport) Firing onclose event.";this._closeError&&(t+=" Error: "+this._closeError),this._logger.log(M.Trace,t),this.onclose(this._closeError)}}}]),t}();function _t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function mt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_t(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var wt=function(){function t(e,n,r,o){l(this,t),this._httpClient=e,this._accessTokenFactory=n,this._logger=r,this._options=o,this.onreceive=null,this.onclose=null}var e;return f(t,[{key:"connect",value:function(){var t=r(c().mark((function t(e,n){var r,o=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(z.isRequired(e,"url"),z.isRequired(n,"transferFormat"),z.isIn(n,i,"transferFormat"),this._logger.log(M.Trace,"(SSE transport) Connecting."),this._url=e,!this._accessTokenFactory){t.next=10;break}return t.next=8,this._accessTokenFactory();case 8:(r=t.sent)&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token=".concat(encodeURIComponent(r)));case 10:return t.abrupt("return",new Promise((function(t,r){var s=!1;if(n===i.Text){var c;if(X.isBrowser||X.isWebWorker)c=new o._options.EventSource(e,{withCredentials:o._options.withCredentials});else{var a=o._httpClient.getCookieString(e),u={};u.Cookie=a;var l=b(Z(),2),h=l[0],f=l[1];u[h]=f,c=new o._options.EventSource(e,{withCredentials:o._options.withCredentials,headers:mt(mt({},u),o._options.headers)})}try{c.onmessage=function(t){if(o.onreceive)try{o._logger.log(M.Trace,"(SSE transport) data received. ".concat(G(t.data,o._options.logMessageContent),".")),o.onreceive(t.data)}catch(t){return void o._close(t)}},c.onerror=function(t){s?o._close():r(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},c.onopen=function(){o._logger.log(M.Information,"SSE connected to ".concat(o._url)),o._eventSource=c,s=!0,t()}}catch(t){return void r(t)}}else r(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})));case 11:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"send",value:(e=r(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._eventSource){t.next=2;break}return t.abrupt("return",Promise.reject(new Error("Cannot send until the transport is connected")));case 2:return t.abrupt("return",K(this._logger,"SSE",this._httpClient,this._url,this._accessTokenFactory,e,this._options));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"stop",value:function(){return this._close(),Promise.resolve()}},{key:"_close",value:function(t){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(t))}}]),t}();function kt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function St(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kt(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ct=function(){function t(e,n,r,o,i,s){l(this,t),this._logger=r,this._accessTokenFactory=n,this._logMessageContent=o,this._webSocketConstructor=i,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=s}return f(t,[{key:"connect",value:function(){var t=r(c().mark((function t(e,n){var r,o=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(z.isRequired(e,"url"),z.isRequired(n,"transferFormat"),z.isIn(n,i,"transferFormat"),this._logger.log(M.Trace,"(WebSockets transport) Connecting."),!this._accessTokenFactory){t.next=9;break}return t.next=7,this._accessTokenFactory();case 7:(r=t.sent)&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token=".concat(encodeURIComponent(r)));case 9:return t.abrupt("return",new Promise((function(t,r){var s;e=e.replace(/^http/,"ws");var c=o._httpClient.getCookieString(e),a=!1;if(X.isNode){var u={},l=b(Z(),2),h=l[0],f=l[1];u[h]=f,c&&(u[gt.Cookie]="".concat(c)),s=new o._webSocketConstructor(e,void 0,{headers:St(St({},u),o._headers)})}s||(s=new o._webSocketConstructor(e)),n===i.Binary&&(s.binaryType="arraybuffer"),s.onopen=function(n){o._logger.log(M.Information,"WebSocket connected to ".concat(e,".")),o._webSocket=s,a=!0,t()},s.onerror=function(t){var e=null;e="undefined"!=typeof ErrorEvent&&t instanceof ErrorEvent?t.error:"There was an error with the transport",o._logger.log(M.Information,"(WebSockets transport) ".concat(e,"."))},s.onmessage=function(t){if(o._logger.log(M.Trace,"(WebSockets transport) data received. ".concat(G(t.data,o._logMessageContent),".")),o.onreceive)try{o.onreceive(t.data)}catch(t){return void o._close(t)}},s.onclose=function(t){if(a)o._close(t);else{var e=null;e="undefined"!=typeof ErrorEvent&&t instanceof ErrorEvent?t.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",r(new Error(e))}}})));case 10:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"send",value:function(t){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(M.Trace,"(WebSockets transport) sending data. ".concat(G(t,this._logMessageContent),".")),this._webSocket.send(t),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}},{key:"stop",value:function(){return this._webSocket&&this._close(void 0),Promise.resolve()}},{key:"_close",value:function(t){this._webSocket&&(this._webSocket.onclose=function(){},this._webSocket.onmessage=function(){},this._webSocket.onerror=function(){},this._webSocket.close(),this._webSocket=void 0),this._logger.log(M.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(t)||!1!==t.wasClean&&1e3===t.code?t instanceof Error?this.onclose(t):this.onclose():this.onclose(new Error("WebSocket closed with status code: ".concat(t.code," (").concat(t.reason||"no reason given",")."))))}},{key:"_isCloseEvent",value:function(t){return t&&"boolean"==typeof t.wasClean&&"number"==typeof t.code}}]),t}();function Et(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return xt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Pt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ot(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Tt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(l(this,t),this._stopPromiseResolver=function(){},this.features={},this._negotiateVersion=1,z.isRequired(e,"url"),this._logger=$(n.logger),this.baseUrl=this._resolveUrl(e),(n=n||{}).logMessageContent=void 0!==n.logMessageContent&&n.logMessageContent,"boolean"!=typeof n.withCredentials&&void 0!==n.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");n.withCredentials=void 0===n.withCredentials||n.withCredentials,n.timeout=void 0===n.timeout?1e5:n.timeout;var r=null,o=null;if(X.isNode){var i=require;r=i("ws"),o=i("eventsource")}X.isNode||"undefined"==typeof WebSocket||n.WebSocket?X.isNode&&!n.WebSocket&&r&&(n.WebSocket=r):n.WebSocket=WebSocket,X.isNode||"undefined"==typeof EventSource||n.EventSource?X.isNode&&!n.EventSource&&void 0!==o&&(n.EventSource=o):n.EventSource=EventSource,this._httpClient=n.httpClient||new pt(this._logger),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=n,this.onreceive=null,this.onclose=null}var e,n,s,a,h,p;return f(t,[{key:"start",value:(p=r(c().mark((function t(e){var n,r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=e||i.Binary,z.isIn(e,i,"transferFormat"),this._logger.log(M.Debug,"Starting connection with transfer format '".concat(i[e],"'.")),"Disconnected"===this._connectionState){t.next=5;break}return t.abrupt("return",Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state.")));case 5:return this._connectionState="Connecting",this._startInternalPromise=this._startInternal(e),t.next=9,this._startInternalPromise;case 9:if("Disconnecting"!==this._connectionState){t.next=17;break}return n="Failed to start the HttpConnection before stop() was called.",this._logger.log(M.Error,n),t.next=14,this._stopPromise;case 14:return t.abrupt("return",Promise.reject(new Error(n)));case 17:if("Connected"===this._connectionState){t.next=21;break}return r="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!",this._logger.log(M.Error,r),t.abrupt("return",Promise.reject(new Error(r)));case 21:this._connectionStarted=!0;case 22:case"end":return t.stop()}}),t,this)}))),function(t){return p.apply(this,arguments)})},{key:"send",value:function(t){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new jt(this.transport)),this._sendQueue.send(t))}},{key:"stop",value:(h=r(c().mark((function t(e){var n=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("Disconnected"!==this._connectionState){t.next=3;break}return this._logger.log(M.Debug,"Call to HttpConnection.stop(".concat(e,") ignored because the connection is already in the disconnected state.")),t.abrupt("return",Promise.resolve());case 3:if("Disconnecting"!==this._connectionState){t.next=6;break}return this._logger.log(M.Debug,"Call to HttpConnection.stop(".concat(e,") ignored because the connection is already in the disconnecting state.")),t.abrupt("return",this._stopPromise);case 6:return this._connectionState="Disconnecting",this._stopPromise=new Promise((function(t){n._stopPromiseResolver=t})),t.next=10,this._stopInternal(e);case 10:return t.next=12,this._stopPromise;case 12:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"_stopInternal",value:(a=r(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._stopError=e,t.prev=1,t.next=4,this._startInternalPromise;case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:if(!this.transport){t.next=21;break}return t.prev=9,t.next=12,this.transport.stop();case 12:t.next=18;break;case 14:t.prev=14,t.t1=t.catch(9),this._logger.log(M.Error,"HttpConnection.transport.stop() threw error '".concat(t.t1,"'.")),this._stopConnection();case 18:this.transport=void 0,t.next=22;break;case 21:this._logger.log(M.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.");case 22:case"end":return t.stop()}}),t,this,[[1,6],[9,14]])}))),function(t){return a.apply(this,arguments)})},{key:"_startInternal",value:(s=r(c().mark((function t(e){var n,r,i,s=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.baseUrl,this._accessTokenFactory=this._options.accessTokenFactory,t.prev=2,!this._options.skipNegotiation){t.next=13;break}if(this._options.transport!==o.WebSockets){t.next=10;break}return this.transport=this._constructTransport(o.WebSockets),t.next=8,this._startTransport(n,e);case 8:t.next=11;break;case 10:throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 11:t.next=32;break;case 13:r=null,i=0;case 15:return t.next=17,this._getNegotiationResponse(n);case 17:if(r=t.sent,"Disconnecting"!==this._connectionState&&"Disconnected"!==this._connectionState){t.next=20;break}throw new Error("The connection was stopped during negotiation.");case 20:if(!r.error){t.next=22;break}throw new Error(r.error);case 22:if(!r.ProtocolVersion){t.next=24;break}throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");case 24:r.url&&(n=r.url),r.accessToken&&function(){var t=r.accessToken;s._accessTokenFactory=function(){return t}}(),i++;case 27:if(r.url&&i<100){t.next=15;break}case 28:if(100!==i||!r.url){t.next=30;break}throw new Error("Negotiate redirection limit exceeded.");case 30:return t.next=32,this._createTransport(n,this._options.transport,r,e);case 32:this.transport instanceof bt&&(this.features.inherentKeepAlive=!0),"Connecting"===this._connectionState&&(this._logger.log(M.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected"),t.next=43;break;case 36:return t.prev=36,t.t0=t.catch(2),this._logger.log(M.Error,"Failed to start the connection: "+t.t0),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),t.abrupt("return",Promise.reject(t.t0));case 43:case"end":return t.stop()}}),t,this,[[2,36]])}))),function(t){return s.apply(this,arguments)})},{key:"_getNegotiationResponse",value:(n=r(c().mark((function t(e){var n,r,o,i,s,a,u,l,h,f;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={},!this._accessTokenFactory){t.next=6;break}return t.next=4,this._accessTokenFactory();case 4:(r=t.sent)&&(n[gt.Authorization]="Bearer ".concat(r));case 6:return o=Z(),i=b(o,2),s=i[0],a=i[1],n[s]=a,u=this._resolveNegotiateUrl(e),this._logger.log(M.Debug,"Sending negotiation request: ".concat(u,".")),t.prev=10,t.next=13,this._httpClient.post(u,{content:"",headers:Pt(Pt({},n),this._options.headers),timeout:this._options.timeout,withCredentials:this._options.withCredentials});case 13:if(200===(l=t.sent).statusCode){t.next=16;break}return t.abrupt("return",Promise.reject(new Error("Unexpected status code returned from negotiate '".concat(l.statusCode,"'"))));case 16:return(!(h=JSON.parse(l.content)).negotiateVersion||h.negotiateVersion<1)&&(h.connectionToken=h.connectionId),t.abrupt("return",h);case 21:return t.prev=21,t.t0=t.catch(10),f="Failed to complete negotiation with the server: "+t.t0,t.t0 instanceof O&&404===t.t0.statusCode&&(f+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(M.Error,f),t.abrupt("return",Promise.reject(new R(f)));case 27:case"end":return t.stop()}}),t,this,[[10,21]])}))),function(t){return n.apply(this,arguments)})},{key:"_createConnectUrl",value:function(t,e){return e?t+(-1===t.indexOf("?")?"?":"&")+"id=".concat(e):t}},{key:"_createTransport",value:(e=r(c().mark((function t(e,n,r,i){var s,a,u,l,h,f,p,g,d;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=this._createConnectUrl(e,r.connectionToken),!this._isITransport(n)){t.next=8;break}return this._logger.log(M.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=n,t.next=6,this._startTransport(s,i);case 6:return this.connectionId=r.connectionId,t.abrupt("return");case 8:a=[],u=r.availableTransports||[],l=r,h=Et(u),t.prev=12,h.s();case 14:if((f=h.n()).done){t.next=53;break}if(p=f.value,!((g=this._resolveTransportOrError(p,n,i))instanceof Error)){t.next=22;break}a.push("".concat(p.transport," failed:")),a.push(g),t.next=51;break;case 22:if(!this._isITransport(g)){t.next=51;break}if(this.transport=g,l){t.next=35;break}return t.prev=25,t.next=28,this._getNegotiationResponse(e);case 28:l=t.sent,t.next=34;break;case 31:return t.prev=31,t.t0=t.catch(25),t.abrupt("return",Promise.reject(t.t0));case 34:s=this._createConnectUrl(e,l.connectionToken);case 35:return t.prev=35,t.next=38,this._startTransport(s,i);case 38:return this.connectionId=l.connectionId,t.abrupt("return");case 42:if(t.prev=42,t.t1=t.catch(35),this._logger.log(M.Error,"Failed to start the transport '".concat(p.transport,"': ").concat(t.t1)),l=void 0,a.push(new D("".concat(p.transport," failed: ").concat(t.t1),o[p.transport])),"Connecting"===this._connectionState){t.next=51;break}return d="Failed to select transport before stop() was called.",this._logger.log(M.Debug,d),t.abrupt("return",Promise.reject(new Error(d)));case 51:t.next=14;break;case 53:t.next=58;break;case 55:t.prev=55,t.t2=t.catch(12),h.e(t.t2);case 58:return t.prev=58,h.f(),t.finish(58);case 61:if(!(a.length>0)){t.next=63;break}return t.abrupt("return",Promise.reject(new A("Unable to connect to the server with any of the available transports. ".concat(a.join(" ")),a)));case 63:return t.abrupt("return",Promise.reject(new Error("None of the transports supported by the client are supported by the server.")));case 64:case"end":return t.stop()}}),t,this,[[12,55,58,61],[25,31],[35,42]])}))),function(t,n,r,o){return e.apply(this,arguments)})},{key:"_constructTransport",value:function(t){switch(t){case o.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new Ct(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case o.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new wt(this._httpClient,this._accessTokenFactory,this._logger,this._options);case o.LongPolling:return new bt(this._httpClient,this._accessTokenFactory,this._logger,this._options);default:throw new Error("Unknown transport: ".concat(t,"."))}}},{key:"_startTransport",value:function(t,e){var n=this;return this.transport.onreceive=this.onreceive,this.transport.onclose=function(t){return n._stopConnection(t)},this.transport.connect(t,e)}},{key:"_resolveTransportOrError",value:function(t,e,n){var r=o[t.transport];if(null==r)return this._logger.log(M.Debug,"Skipping transport '".concat(t.transport,"' because it is not supported by this client.")),new Error("Skipping transport '".concat(t.transport,"' because it is not supported by this client."));if(!function(t,e){return!t||0!=(e&t)}(e,r))return this._logger.log(M.Debug,"Skipping transport '".concat(o[r],"' because it was disabled by the client.")),new I("'".concat(o[r],"' is disabled by the client."),r);if(!(t.transferFormats.map((function(t){return i[t]})).indexOf(n)>=0))return this._logger.log(M.Debug,"Skipping transport '".concat(o[r],"' because it does not support the requested transfer format '").concat(i[n],"'.")),new Error("'".concat(o[r],"' does not support ").concat(i[n],"."));if(r===o.WebSockets&&!this._options.WebSocket||r===o.ServerSentEvents&&!this._options.EventSource)return this._logger.log(M.Debug,"Skipping transport '".concat(o[r],"' because it is not supported in your environment.'")),new j("'".concat(o[r],"' is not supported in your environment."),r);this._logger.log(M.Debug,"Selecting transport '".concat(o[r],"'."));try{return this._constructTransport(r)}catch(t){return t}}},{key:"_isITransport",value:function(t){return t&&"object"===u(t)&&"connect"in t}},{key:"_stopConnection",value:function(t){var e=this;if(this._logger.log(M.Debug,"HttpConnection.stopConnection(".concat(t,") called while in state ").concat(this._connectionState,".")),this.transport=void 0,t=this._stopError||t,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(M.Warning,"Call to HttpConnection.stopConnection(".concat(t,") was ignored because the connection is still in the connecting state.")),new Error("HttpConnection.stopConnection(".concat(t,") was called while the connection is still in the connecting state."));if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),t?this._logger.log(M.Error,"Connection disconnected with error '".concat(t,"'.")):this._logger.log(M.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch((function(t){e._logger.log(M.Error,"TransportSendQueue.stop() threw error '".concat(t,"'."))})),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(t)}catch(e){this._logger.log(M.Error,"HttpConnection.onclose(".concat(t,") threw error '").concat(e,"'."))}}}else this._logger.log(M.Debug,"Call to HttpConnection.stopConnection(".concat(t,") was ignored because the connection is already in the disconnected state."))}},{key:"_resolveUrl",value:function(t){if(0===t.lastIndexOf("https://",0)||0===t.lastIndexOf("http://",0))return t;if(!X.isBrowser)throw new Error("Cannot resolve '".concat(t,"'."));var e=window.document.createElement("a");return e.href=t,this._logger.log(M.Information,"Normalizing '".concat(t,"' to '").concat(e.href,"'.")),e.href}},{key:"_resolveNegotiateUrl",value:function(t){var e=t.indexOf("?"),n=t.substring(0,-1===e?t.length:e);return"/"!==n[n.length-1]&&(n+="/"),n+="negotiate",-1===(n+=-1===e?"":t.substring(e)).indexOf("negotiateVersion")&&(n+=-1===e?"?":"&",n+="negotiateVersion="+this._negotiateVersion),n}}]),t}();var jt=function(){function t(e){l(this,t),this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new It,this._transportResult=new It,this._sendLoopPromise=this._sendLoop()}var e;return f(t,[{key:"send",value:function(t){return this._bufferData(t),this._transportResult||(this._transportResult=new It),this._transportResult.promise}},{key:"stop",value:function(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}},{key:"_bufferData",value:function(t){if(this._buffer.length&&u(this._buffer[0])!==u(t))throw new Error("Expected data to be of type ".concat(u(this._buffer)," but was of type ").concat(u(t)));this._buffer.push(t),this._sendBufferedData.resolve()}},{key:"_sendLoop",value:(e=r(c().mark((function e(){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this._sendBufferedData.promise;case 3:if(this._executing){e.next=6;break}return this._transportResult&&this._transportResult.reject("Connection stopped."),e.abrupt("break",22);case 6:return this._sendBufferedData=new It,n=this._transportResult,this._transportResult=void 0,r="string"==typeof this._buffer[0]?this._buffer.join(""):t._concatBuffers(this._buffer),this._buffer.length=0,e.prev=11,e.next=14,this._transport.send(r);case 14:n.resolve(),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(11),n.reject(e.t0);case 20:e.next=0;break;case 22:case"end":return e.stop()}}),e,this,[[11,17]])}))),function(){return e.apply(this,arguments)})}],[{key:"_concatBuffers",value:function(t){var e,n=t.map((function(t){return t.byteLength})).reduce((function(t,e){return t+e})),r=new Uint8Array(n),o=0,i=Et(t);try{for(i.s();!(e=i.n()).done;){var s=e.value;r.set(new Uint8Array(s),o),o+=s.byteLength}}catch(t){i.e(t)}finally{i.f()}return r.buffer}}]),t}(),It=function(){function t(){var e=this;l(this,t),this.promise=new Promise((function(t,n){var r;return r=[t,n],e._resolver=r[0],e._rejecter=r[1],r}))}return f(t,[{key:"resolve",value:function(){this._resolver()}},{key:"reject",value:function(t){this._rejecter(t)}}]),t}(),Dt=function(){function t(){l(this,t)}return f(t,null,[{key:"write",value:function(e){return"".concat(e).concat(t.RecordSeparator)}},{key:"parse",value:function(e){if(e[e.length-1]!==t.RecordSeparator)throw new Error("Message is incomplete.");var n=e.split(t.RecordSeparator);return n.pop(),n}}]),t}();Dt.RecordSeparatorCode=30,Dt.RecordSeparator=String.fromCharCode(Dt.RecordSeparatorCode);var Rt,At=function(){function t(){l(this,t)}return f(t,[{key:"writeHandshakeRequest",value:function(t){return Dt.write(JSON.stringify(t))}},{key:"parseHandshakeResponse",value:function(t){var e,n;if(J(t)){var r=new Uint8Array(t),o=r.indexOf(Dt.RecordSeparatorCode);if(-1===o)throw new Error("Message is incomplete.");var i=o+1;e=String.fromCharCode.apply(null,Array.prototype.slice.call(r.slice(0,i))),n=r.byteLength>i?r.slice(i).buffer:null}else{var s=t,c=s.indexOf(Dt.RecordSeparator);if(-1===c)throw new Error("Message is incomplete.");var a=c+1;e=s.substring(0,a),n=s.length>a?s.substring(a):null}var u=Dt.parse(e),l=JSON.parse(u[0]);if(l.type)throw new Error("Expected a handshake response from the server.");return[n,l]}}]),t}();function Lt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ht(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ht(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function Ht(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}!function(t){t[t.Invocation=1]="Invocation",t[t.StreamItem=2]="StreamItem",t[t.Completion=3]="Completion",t[t.StreamInvocation=4]="StreamInvocation",t[t.CancelInvocation=5]="CancelInvocation",t[t.Ping=6]="Ping",t[t.Close=7]="Close"}(Rt||(Rt={}));var Mt=function(){function t(){l(this,t),this.observers=[]}return f(t,[{key:"next",value:function(t){var e,n=Lt(this.observers);try{for(n.s();!(e=n.n()).done;){e.value.next(t)}}catch(t){n.e(t)}finally{n.f()}}},{key:"error",value:function(t){var e,n=Lt(this.observers);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.error&&r.error(t)}}catch(t){n.e(t)}finally{n.f()}}},{key:"complete",value:function(){var t,e=Lt(this.observers);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.complete&&n.complete()}}catch(t){e.e(t)}finally{e.f()}}},{key:"subscribe",value:function(t){return this.observers.push(t),new Q(this,t)}}]),t}();function Nt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Wt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function Wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ft;!function(t){t.Disconnected="Disconnected",t.Connecting="Connecting",t.Connected="Connected",t.Disconnecting="Disconnecting",t.Reconnecting="Reconnecting"}(Ft||(Ft={}));var qt=function(){function t(e,n,r,o){var i=this;l(this,t),this._nextKeepAlive=0,this._freezeEventListener=function(){i._logger.log(M.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},z.isRequired(e,"connection"),z.isRequired(n,"logger"),z.isRequired(r,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this._logger=n,this._protocol=r,this.connection=e,this._reconnectPolicy=o,this._handshakeProtocol=new At,this.connection.onreceive=function(t){return i._processIncomingData(t)},this.connection.onclose=function(t){return i._connectionClosed(t)},this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=Ft.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:Rt.Ping})}var e,n,o,i;return f(t,[{key:"state",get:function(){return this._connectionState}},{key:"connectionId",get:function(){return this.connection&&this.connection.connectionId||null}},{key:"baseUrl",get:function(){return this.connection.baseUrl||""},set:function(t){if(this._connectionState!==Ft.Disconnected&&this._connectionState!==Ft.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!t)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=t}},{key:"start",value:function(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}},{key:"_startWithStateTransitions",value:(i=r(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._connectionState===Ft.Disconnected){t.next=2;break}return t.abrupt("return",Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state.")));case 2:return this._connectionState=Ft.Connecting,this._logger.log(M.Debug,"Starting HubConnection."),t.prev=4,t.next=7,this._startInternal();case 7:X.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=Ft.Connected,this._connectionStarted=!0,this._logger.log(M.Debug,"HubConnection connected successfully."),t.next=18;break;case 13:return t.prev=13,t.t0=t.catch(4),this._connectionState=Ft.Disconnected,this._logger.log(M.Debug,"HubConnection failed to start successfully because of error '".concat(t.t0,"'.")),t.abrupt("return",Promise.reject(t.t0));case 18:case"end":return t.stop()}}),t,this,[[4,13]])}))),function(){return i.apply(this,arguments)})},{key:"_startInternal",value:(o=r(c().mark((function t(){var e,n,r=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1,e=new Promise((function(t,e){r._handshakeResolver=t,r._handshakeRejecter=e})),t.next=5,this.connection.start(this._protocol.transferFormat);case 5:return t.prev=5,n={protocol:this._protocol.name,version:this._protocol.version},this._logger.log(M.Debug,"Sending handshake request."),t.next=10,this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(n));case 10:return this._logger.log(M.Information,"Using HubProtocol '".concat(this._protocol.name,"'.")),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),t.next=16,e;case 16:if(!this._stopDuringStartError){t.next=18;break}throw this._stopDuringStartError;case 18:t.next=28;break;case 20:return t.prev=20,t.t0=t.catch(5),this._logger.log(M.Debug,"Hub handshake failed with error '".concat(t.t0,"' during start(). Stopping HubConnection.")),this._cleanupTimeout(),this._cleanupPingTimer(),t.next=27,this.connection.stop(t.t0);case 27:throw t.t0;case 28:case"end":return t.stop()}}),t,this,[[5,20]])}))),function(){return o.apply(this,arguments)})},{key:"stop",value:(n=r(c().mark((function t(){var e;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this._startPromise,this._stopPromise=this._stopInternal(),t.next=4,this._stopPromise;case 4:return t.prev=4,t.next=7,e;case 7:t.next=11;break;case 9:t.prev=9,t.t0=t.catch(4);case 11:case"end":return t.stop()}}),t,this,[[4,9]])}))),function(){return n.apply(this,arguments)})},{key:"_stopInternal",value:function(t){return this._connectionState===Ft.Disconnected?(this._logger.log(M.Debug,"Call to HubConnection.stop(".concat(t,") ignored because it is already in the disconnected state.")),Promise.resolve()):this._connectionState===Ft.Disconnecting?(this._logger.log(M.Debug,"Call to HttpConnection.stop(".concat(t,") ignored because the connection is already in the disconnecting state.")),this._stopPromise):(this._connectionState=Ft.Disconnecting,this._logger.log(M.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(M.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=t||new Error("The connection was stopped before the hub handshake could complete."),this.connection.stop(t)))}},{key:"stream",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i,s=this._replaceStreamingParams(r),c=b(s,2),a=c[0],u=c[1],l=this._createStreamInvocation(t,r,u),h=new Mt;return h.cancelCallback=function(){var t=e._createCancelInvocation(l.invocationId);return delete e._callbacks[l.invocationId],i.then((function(){return e._sendWithProtocol(t)}))},this._callbacks[l.invocationId]=function(t,e){e?h.error(e):t&&(t.type===Rt.Completion?t.error?h.error(new Error(t.error)):h.complete():h.next(t.item))},i=this._sendWithProtocol(l).catch((function(t){h.error(t),delete e._callbacks[l.invocationId]})),this._launchStreams(a,i),h}},{key:"_sendMessage",value:function(t){return this._resetKeepAliveInterval(),this.connection.send(t)}},{key:"_sendWithProtocol",value:function(t){return this._sendMessage(this._protocol.writeMessage(t))}},{key:"send",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var o=this._replaceStreamingParams(n),i=b(o,2),s=i[0],c=i[1],a=this._sendWithProtocol(this._createInvocation(t,n,!0,c));return this._launchStreams(s,a),a}},{key:"invoke",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=this._replaceStreamingParams(r),s=b(i,2),c=s[0],a=s[1],u=this._createInvocation(t,r,!1,a),l=new Promise((function(t,n){e._callbacks[u.invocationId]=function(e,r){r?n(r):e&&(e.type===Rt.Completion?e.error?n(new Error(e.error)):t(e.result):n(new Error("Unexpected message type: ".concat(e.type))))};var r=e._sendWithProtocol(u).catch((function(t){n(t),delete e._callbacks[u.invocationId]}));e._launchStreams(c,r)}));return l}},{key:"on",value:function(t,e){t&&e&&(t=t.toLowerCase(),this._methods[t]||(this._methods[t]=[]),-1===this._methods[t].indexOf(e)&&this._methods[t].push(e))}},{key:"off",value:function(t,e){if(t){t=t.toLowerCase();var n=this._methods[t];if(n)if(e){var r=n.indexOf(e);-1!==r&&(n.splice(r,1),0===n.length&&delete this._methods[t])}else delete this._methods[t]}}},{key:"onclose",value:function(t){t&&this._closedCallbacks.push(t)}},{key:"onreconnecting",value:function(t){t&&this._reconnectingCallbacks.push(t)}},{key:"onreconnected",value:function(t){t&&this._reconnectedCallbacks.push(t)}},{key:"_processIncomingData",value:function(t){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(t=this._processHandshakeResponse(t),this._receivedHandshakeResponse=!0),t){var e,n=Nt(this._protocol.parseMessages(t,this._logger));try{for(n.s();!(e=n.n()).done;){var r=e.value;switch(r.type){case Rt.Invocation:this._invokeClientMethod(r);break;case Rt.StreamItem:case Rt.Completion:var o=this._callbacks[r.invocationId];if(o){r.type===Rt.Completion&&delete this._callbacks[r.invocationId];try{o(r)}catch(t){this._logger.log(M.Error,"Stream callback threw error: ".concat(ot(t)))}}break;case Rt.Ping:break;case Rt.Close:this._logger.log(M.Information,"Close message received from server.");var i=r.error?new Error("Server returned an error on close: "+r.error):void 0;!0===r.allowReconnect?this.connection.stop(i):this._stopPromise=this._stopInternal(i);break;default:this._logger.log(M.Warning,"Invalid message type: ".concat(r.type,"."))}}}catch(t){n.e(t)}finally{n.f()}}this._resetTimeoutPeriod()}},{key:"_processHandshakeResponse",value:function(t){var e,n;try{var r=b(this._handshakeProtocol.parseHandshakeResponse(t),2);n=r[0],e=r[1]}catch(t){var o="Error parsing handshake response: "+t;this._logger.log(M.Error,o);var i=new Error(o);throw this._handshakeRejecter(i),i}if(e.error){var s="Server returned handshake error: "+e.error;this._logger.log(M.Error,s);var c=new Error(s);throw this._handshakeRejecter(c),c}return this._logger.log(M.Debug,"Server handshake complete."),this._handshakeResolver(),n}},{key:"_resetKeepAliveInterval",value:function(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}},{key:"_resetTimeoutPeriod",value:function(){var t=this;if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout((function(){return t.serverTimeout()}),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){var e=this._nextKeepAlive-(new Date).getTime();e<0&&(e=0),this._pingServerHandle=setTimeout(r(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._connectionState!==Ft.Connected){e.next=9;break}return e.prev=1,e.next=4,t._sendMessage(t._cachedPingMessage);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),t._cleanupPingTimer();case 9:case"end":return e.stop()}}),e,null,[[1,6]])}))),e)}}},{key:"serverTimeout",value:function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}},{key:"_invokeClientMethod",value:function(t){var e=this,n=this._methods[t.target.toLowerCase()];if(n){try{n.forEach((function(n){return n.apply(e,t.arguments)}))}catch(e){this._logger.log(M.Error,"A callback for the method ".concat(t.target.toLowerCase()," threw error '").concat(e,"'."))}if(t.invocationId){var r="Server requested a response, which is not supported in this version of the client.";this._logger.log(M.Error,r),this._stopPromise=this._stopInternal(new Error(r))}}else this._logger.log(M.Warning,"No client method with the name '".concat(t.target,"' found."))}},{key:"_connectionClosed",value:function(t){this._logger.log(M.Debug,"HubConnection.connectionClosed(".concat(t,") called while in state ").concat(this._connectionState,".")),this._stopDuringStartError=this._stopDuringStartError||t||new Error("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(t||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===Ft.Disconnecting?this._completeClose(t):this._connectionState===Ft.Connected&&this._reconnectPolicy?this._reconnect(t):this._connectionState===Ft.Connected&&this._completeClose(t)}},{key:"_completeClose",value:function(t){var e=this;if(this._connectionStarted){this._connectionState=Ft.Disconnected,this._connectionStarted=!1,X.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach((function(n){return n.apply(e,[t])}))}catch(e){this._logger.log(M.Error,"An onclose callback called with error '".concat(t,"' threw error '").concat(e,"'."))}}}},{key:"_reconnect",value:(e=r(c().mark((function t(e){var n,r,o,i,s=this;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=Date.now(),r=0,o=void 0!==e?e:new Error("Attempting to reconnect due to a unknown error."),null!==(i=this._getNextRetryDelay(r++,0,o))){t.next=8;break}return this._logger.log(M.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this._completeClose(e),t.abrupt("return");case 8:if(this._connectionState=Ft.Reconnecting,e?this._logger.log(M.Information,"Connection reconnecting because of error '".concat(e,"'.")):this._logger.log(M.Information,"Connection reconnecting."),0===this._reconnectingCallbacks.length){t.next=15;break}try{this._reconnectingCallbacks.forEach((function(t){return t.apply(s,[e])}))}catch(t){this._logger.log(M.Error,"An onreconnecting callback called with error '".concat(e,"' threw error '").concat(t,"'."))}if(this._connectionState===Ft.Reconnecting){t.next=15;break}return this._logger.log(M.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting."),t.abrupt("return");case 15:if(null===i){t.next=43;break}return this._logger.log(M.Information,"Reconnect attempt number ".concat(r," will start in ").concat(i," ms.")),t.next=19,new Promise((function(t){s._reconnectDelayHandle=setTimeout(t,i)}));case 19:if(this._reconnectDelayHandle=void 0,this._connectionState===Ft.Reconnecting){t.next=23;break}return this._logger.log(M.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting."),t.abrupt("return");case 23:return t.prev=23,t.next=26,this._startInternal();case 26:if(this._connectionState=Ft.Connected,this._logger.log(M.Information,"HubConnection reconnected successfully."),0!==this._reconnectedCallbacks.length)try{this._reconnectedCallbacks.forEach((function(t){return t.apply(s,[s.connection.connectionId])}))}catch(t){this._logger.log(M.Error,"An onreconnected callback called with connectionId '".concat(this.connection.connectionId,"; threw error '").concat(t,"'."))}return t.abrupt("return");case 32:if(t.prev=32,t.t0=t.catch(23),this._logger.log(M.Information,"Reconnect attempt failed because of error '".concat(t.t0,"'.")),this._connectionState===Ft.Reconnecting){t.next=39;break}return this._logger.log(M.Debug,"Connection moved to the '".concat(this._connectionState,"' from the reconnecting state during reconnect attempt. Done reconnecting.")),this._connectionState===Ft.Disconnecting&&this._completeClose(),t.abrupt("return");case 39:o=t.t0 instanceof Error?t.t0:new Error(t.t0.toString()),i=this._getNextRetryDelay(r++,Date.now()-n,o);case 41:t.next=15;break;case 43:this._logger.log(M.Information,"Reconnect retries have been exhausted after ".concat(Date.now()-n," ms and ").concat(r," failed attempts. Connection disconnecting.")),this._completeClose();case 45:case"end":return t.stop()}}),t,this,[[23,32]])}))),function(t){return e.apply(this,arguments)})},{key:"_getNextRetryDelay",value:function(t,e,n){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:e,previousRetryCount:t,retryReason:n})}catch(n){return this._logger.log(M.Error,"IRetryPolicy.nextRetryDelayInMilliseconds(".concat(t,", ").concat(e,") threw error '").concat(n,"'.")),null}}},{key:"_cancelCallbacksWithError",value:function(t){var e=this,n=this._callbacks;this._callbacks={},Object.keys(n).forEach((function(r){var o=n[r];try{o(null,t)}catch(n){e._logger.log(M.Error,"Stream 'error' callback called with '".concat(t,"' threw error: ").concat(ot(n)))}}))}},{key:"_cleanupPingTimer",value:function(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}},{key:"_cleanupTimeout",value:function(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}},{key:"_createInvocation",value:function(t,e,n,r){if(n)return 0!==r.length?{arguments:e,streamIds:r,target:t,type:Rt.Invocation}:{arguments:e,target:t,type:Rt.Invocation};var o=this._invocationId;return this._invocationId++,0!==r.length?{arguments:e,invocationId:o.toString(),streamIds:r,target:t,type:Rt.Invocation}:{arguments:e,invocationId:o.toString(),target:t,type:Rt.Invocation}}},{key:"_launchStreams",value:function(t,e){var n=this;if(0!==t.length){e||(e=Promise.resolve());var r=function(r){t[r].subscribe({complete:function(){e=e.then((function(){return n._sendWithProtocol(n._createCompletionMessage(r))}))},error:function(t){var o;o=t instanceof Error?t.message:t&&t.toString?t.toString():"Unknown error",e=e.then((function(){return n._sendWithProtocol(n._createCompletionMessage(r,o))}))},next:function(t){e=e.then((function(){return n._sendWithProtocol(n._createStreamItemMessage(r,t))}))}})};for(var o in t)r(o)}}},{key:"_replaceStreamingParams",value:function(t){for(var e=[],n=[],r=0;r<t.length;r++){var o=t[r];if(this._isObservable(o)){var i=this._invocationId;this._invocationId++,e[i]=o,n.push(i.toString()),t.splice(r,1)}}return[e,n]}},{key:"_isObservable",value:function(t){return t&&t.subscribe&&"function"==typeof t.subscribe}},{key:"_createStreamInvocation",value:function(t,e,n){var r=this._invocationId;return this._invocationId++,0!==n.length?{arguments:e,invocationId:r.toString(),streamIds:n,target:t,type:Rt.StreamInvocation}:{arguments:e,invocationId:r.toString(),target:t,type:Rt.StreamInvocation}}},{key:"_createCancelInvocation",value:function(t){return{invocationId:t,type:Rt.CancelInvocation}}},{key:"_createStreamItemMessage",value:function(t,e){return{invocationId:t,item:e,type:Rt.StreamItem}}},{key:"_createCompletionMessage",value:function(t,e,n){return e?{error:e,invocationId:t,type:Rt.Completion}:{invocationId:t,result:n,type:Rt.Completion}}}],[{key:"create",value:function(e,n,r,o){return new t(e,n,r,o)}}]),t}();function Bt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ut(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ut(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,i=t},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function Ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var zt=function(){function t(){l(this,t),this.name="json",this.version=1,this.transferFormat=i.Text}return f(t,[{key:"parseMessages",value:function(t,e){if("string"!=typeof t)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!t)return[];null===e&&(e=F.instance);var n,r=[],o=Bt(Dt.parse(t));try{for(o.s();!(n=o.n()).done;){var i=n.value,s=JSON.parse(i);if("number"!=typeof s.type)throw new Error("Invalid payload.");switch(s.type){case Rt.Invocation:this._isInvocationMessage(s);break;case Rt.StreamItem:this._isStreamItemMessage(s);break;case Rt.Completion:this._isCompletionMessage(s);break;case Rt.Ping:case Rt.Close:break;default:e.log(M.Information,"Unknown message type '"+s.type+"' ignored.");continue}r.push(s)}}catch(t){o.e(t)}finally{o.f()}return r}},{key:"writeMessage",value:function(t){return Dt.write(JSON.stringify(t))}},{key:"_isInvocationMessage",value:function(t){this._assertNotEmptyString(t.target,"Invalid payload for Invocation message."),void 0!==t.invocationId&&this._assertNotEmptyString(t.invocationId,"Invalid payload for Invocation message.")}},{key:"_isStreamItemMessage",value:function(t){if(this._assertNotEmptyString(t.invocationId,"Invalid payload for StreamItem message."),void 0===t.item)throw new Error("Invalid payload for StreamItem message.")}},{key:"_isCompletionMessage",value:function(t){if(t.result&&t.error)throw new Error("Invalid payload for Completion message.");!t.result&&t.error&&this._assertNotEmptyString(t.error,"Invalid payload for Completion message."),this._assertNotEmptyString(t.invocationId,"Invalid payload for Completion message.")}},{key:"_assertNotEmptyString",value:function(t,e){if("string"!=typeof t||""===t)throw new Error(e)}}]),t}();function Xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Gt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xt(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Jt={trace:M.Trace,debug:M.Debug,info:M.Information,information:M.Information,warn:M.Warning,warning:M.Warning,error:M.Error,critical:M.Critical,none:M.None};var Kt=function(){function t(){l(this,t)}return f(t,[{key:"configureLogging",value:function(t){if(z.isRequired(t,"logging"),void 0!==t.log)this.logger=t;else if("string"==typeof t){var e=function(t){var e=Jt[t.toLowerCase()];if(void 0!==e)return e;throw new Error("Unknown log level: ".concat(t))}(t);this.logger=new Y(e)}else this.logger=new Y(t);return this}},{key:"withUrl",value:function(t,e){return z.isRequired(t,"url"),z.isNotEmpty(t,"url"),this.url=t,"object"===u(e)?this.httpConnectionOptions=Gt(Gt({},this.httpConnectionOptions),e):this.httpConnectionOptions=Gt(Gt({},this.httpConnectionOptions),{},{transport:e}),this}},{key:"withHubProtocol",value:function(t){return z.isRequired(t,"protocol"),this.protocol=t,this}},{key:"withAutomaticReconnect",value:function(t){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return t?Array.isArray(t)?this.reconnectPolicy=new y(t):this.reconnectPolicy=t:this.reconnectPolicy=new y,this}},{key:"build",value:function(){var t=this.httpConnectionOptions||{};if(void 0===t.logger&&(t.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var e=new Tt(this.url,t);return qt.create(e,this.logger||F.instance,this.protocol||new zt,this.reconnectPolicy)}}]),t}();n(442)}(),r=r.default}()}));